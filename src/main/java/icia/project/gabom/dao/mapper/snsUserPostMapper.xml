<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="icia.project.gabom.dao.SnsUserPostDao">

	<select id="check" resultType="friendS">
		SELECT FRIEND_STATUS STATUS FROM
		SNS_FRIEND
		WHERE FRIEND_MY_ID=#{id} AND FRIEND_ID=#{userId}
	</select>
	<select id="userPublicPost" resultType="snspost">
	<![CDATA[
		SELECT * FROM SNS_POSTS SP INNER JOIN(
		SELECT DISTINCT SP.SNS_POSTS_NUMBER,SP.SNS_POSTS_WRITER
		,SP.SNS_POSTS_DATE,SP.SNS_POSTS_EDIT_DATE,
		SP.SNS_POSTS_HASHTAG,SP.SNS_POSTS_AUTHORITY,
		SP.SNS_POSTS_REPORT,DBMS_LOB.SUBSTR(SP.SNS_POSTS_CONTENT,
		DBMS_LOB.GETLENGTH(SP.SNS_POSTS_CONTENT))
		FROM SNS_POSTS SP
		LEFT JOIN SNS_FRIEND SF ON SP.SNS_POSTS_WRITER=SF.FRIEND_ID
		WHERE SP.SNS_POSTS_AUTHORITY=0 ORDER BY SP.SNS_POSTS_NUMBER DESC) TOT
		ON SP.SNS_POSTS_NUMBER=TOT.SNS_POSTS_NUMBER WHERE ROWNUM<=#{rowNum} AND
		SP.SNS_POSTS_WRITER=#{userId}]]>
	</select>
	<select id="userFriendPost" resultType="snspost">
	<![CDATA[
		SELECT * FROM SNS_POSTS SP INNER JOIN(
		SELECT DISTINCT SP.SNS_POSTS_NUMBER,SP.SNS_POSTS_WRITER
		,SP.SNS_POSTS_DATE,SP.SNS_POSTS_EDIT_DATE,
		SP.SNS_POSTS_HASHTAG,SP.SNS_POSTS_AUTHORITY,
		SP.SNS_POSTS_REPORT,DBMS_LOB.SUBSTR(SP.SNS_POSTS_CONTENT,
		DBMS_LOB.GETLENGTH(SP.SNS_POSTS_CONTENT))
		FROM SNS_POSTS SP 
		LEFT JOIN SNS_FRIEND SF ON SP.SNS_POSTS_WRITER=SF.FRIEND_ID
		WHERE SP.SNS_POSTS_AUTHORITY=0 OR SP.SNS_POSTS_AUTHORITY=1
		ORDER BY SP.SNS_POSTS_NUMBER DESC) TOT
		ON SP.SNS_POSTS_NUMBER=TOT.SNS_POSTS_NUMBER WHERE ROWNUM<=#{rowNum}
		 AND SP.SNS_POSTS_WRITER=#{userId}]]>
	</select>
	<select id="checkNumber" resultType="int">
	SELECT COUNT(SNS_POSTS_NUMBER) FROM SNS_POSTS WHERE SNS_POSTS_WRITER=#{userId}
	</select>
</mapper>