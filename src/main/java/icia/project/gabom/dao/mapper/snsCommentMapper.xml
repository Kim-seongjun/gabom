<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="icia.project.gabom.dao.SnsCommentDao">
	<select id="snsComment" resultType="snsCommentDto">
<![CDATA[
	  SELECT
  SNS_COMMENT_NUMBER COMMENTNUMBER,
	SNS_COMMENT_CONTENT CONTENT,
	SNS_COMMENT_MEMBER_ID ID,
	SNS_COMMENT_DATE COMMENTDATE,
	SNS_COMMENT_EDIT_DATE EDITDATE,
	SNS_POSTS_NUMBER POSTNUMBER,
	SNS_COMMENT_REPORT REPORT FROM SNS_COMMENT JOIN
	(SELECT ROW_NUMBER() 
  	OVER(ORDER BY SNS_COMMENT_DATE)
  	AS RN,
  	SNS_COMMENT_NUMBER COMMENTNUMBER,
	SNS_COMMENT_CONTENT CONTENT,
	SNS_COMMENT_MEMBER_ID ID,
	SNS_COMMENT_DATE COMMENTDATE,
	SNS_COMMENT_EDIT_DATE EDITDATE,
	SNS_POSTS_NUMBER POSTNUMBER,
	SNS_COMMENT_REPORT REPORT FROM SNS_COMMENT
	WHERE SNS_POSTS_NUMBER=#{postNumber}
	ORDER BY SNS_COMMENT_DATE) TOT
  	ON SNS_COMMENT.SNS_COMMENT_NUMBER=TOT.COMMENTNUMBER
  	WHERE TOT.RN<=#{rowNum} ORDER BY TOT.RN
						]]>
	</select>
	<select id="commentLikeHateGet" resultType="snsLikeHate">
		SELECT COUNT(SNS_COMMENT_LIKE) SNSLIKE,
		COUNT(SNS_COMMENT_HATE) SNSHATE
		FROM SNS_COMMENT_LIKE_HATE_COUNTER
		WHERE SNS_COMMENT_NUMBER=#{commentNumber}
	</select>
	<select id="check" resultType="int">
	SELECT COUNT(SNS_COMMENT_NUMBER) FROM SNS_COMMENT WHERE SNS_POSTS_NUMBER=#{postNumber}	
	</select>
</mapper>